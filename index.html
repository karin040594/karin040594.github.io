<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì „êµ­ ëŒ€í•™êµ í•™ê³¼ ê²€ìƒ‰ ì‹œìŠ¤í…œ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        /* ê¹”ë”í•œ í™ˆí˜ì´ì§€ ìŠ¤íƒ€ì¼ */
        body { font-family: 'Malgun Gothic', sans-serif; background: #f0f2f5; margin: 0; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 30px; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }
        .filter-group { display: flex; gap: 10px; margin-bottom: 25px; flex-wrap: wrap; border-bottom: 2px solid #eee; padding-bottom: 20px; }
        select, input { flex: 1; min-width: 150px; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; }
        button { padding: 12px 25px; background: #007bff; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; }
        button:hover { background: #0056b3; }
        .status { margin-bottom: 10px; font-size: 14px; color: #666; }
        table { width: 100%; border-collapse: collapse; }
        th { background: #007bff; color: white; padding: 15px; text-align: left; position: sticky; top: 0; }
        td { padding: 12px; border-bottom: 1px solid #eee; font-size: 14px; }
        tr:nth-child(even) { background-color: #f9f9f9; }
        .no-result { text-align: center; padding: 50px; color: #999; }
    </style>
</head>
<body>

<div class="container">
    <h2>ğŸ« ëŒ€í•™êµ í•™ê³¼ ìƒì„¸ ê²€ìƒ‰</h2>
    <p class="status">ì—‘ì…€ íŒŒì¼ì„ ì„ íƒí•˜ê±°ë‚˜ ê²€ìƒ‰ ì¡°ê±´ì„ ì…ë ¥í•˜ì„¸ìš”.</p>

    <div class="filter-group">
        <input type="file" id="excelFile" accept=".csv, .xls, .xlsx" style="flex: 2;">
        <select id="regionSelect"><option value="">ì§€ì—­(ì „ì²´)</option></select>
        <select id="typeSelect"><option value="">í•™êµêµ¬ë¶„(ì „ì²´)</option></select>
        <input type="text" id="schoolInput" placeholder="í•™êµëª… ì…ë ¥">
        <button onclick="applyFilter()">ê²€ìƒ‰</button>
    </div>

    <div id="countInfo" style="margin-bottom: 10px; font-weight: bold;"></div>

    <div style="max-height: 600px; overflow-y: auto; border: 1px solid #ddd;">
        <table>
            <thead>
                <tr>
                    <th>ì‹œë„ëª…</th>
                    <th>í•™êµëª…</th>
                    <th>í•™êµêµ¬ë¶„</th>
                    <th>í•™ê³¼ëª…</th>
                    <th>ì£¼ì•¼êµ¬ë¶„</th>
                </tr>
            </thead>
            <tbody id="tableBody">
                <tr><td colspan="5" class="no-result">ë°ì´í„° íŒŒì¼ì„ ì—…ë¡œë“œí•´ ì£¼ì„¸ìš”.</td></tr>
            </tbody>
        </table>
    </div>
</div>

<script>
    let rawData = []; // ì „ì²´ ë°ì´í„° ì €ì¥ ë³€ìˆ˜

    // ì—‘ì…€ íŒŒì¼ ì½ê¸° ì²˜ë¦¬
    document.getElementById('excelFile').addEventListener('change', function(e) {
        const file = e.target.files[0];
        const reader = new FileReader();
        
        reader.onload = function(e) {
            const data = new Uint8Array(e.target.result);
            const workbook = XLSX.read(data, {type: 'array'});
            const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
            rawData = XLSX.utils.sheet_to_json(firstSheet);
            
            // í•„í„° ì˜µì…˜ ìƒì„±
            setupFilters();
            alert("ë°ì´í„° ë¡œë“œ ì™„ë£Œ! ì´ " + rawData.length + "ê±´");
        };
        reader.readAsArrayBuffer(file);
    });

    function setupFilters() {
        const regions = [...new Set(rawData.map(item => item.ì‹œë„ëª…))].filter(Boolean).sort();
        const types = [...new Set(rawData.map(item => item.í•™êµêµ¬ë¶„ëª…))].filter(Boolean).sort();

        const rSelect = document.getElementById('regionSelect');
        const tSelect = document.getElementById('typeSelect');

        regions.forEach(r => rSelect.innerHTML += `<option value="${r}">${r}</option>`);
        types.forEach(t => tSelect.innerHTML += `<option value="${t}">${t}</option>`);
    }

    function applyFilter() {
        const region = document.getElementById('regionSelect').value;
        const type = document.getElementById('typeSelect').value;
        const schoolName = document.getElementById('schoolInput').value.toLowerCase();
        const tbody = document.getElementById('tableBody');
        
        const filtered = rawData.filter(item => {
            return (!region || item.ì‹œë„ëª… === region) &&
                   (!type || item.í•™êµêµ¬ë¶„ëª… === type) &&
                   (!schoolName || String(item.í•™êµëª…).toLowerCase().includes(schoolName));
        });

        document.getElementById('countInfo').innerText = `ê²€ìƒ‰ ê²°ê³¼: ${filtered.length}ê±´`;
        
        tbody.innerHTML = filtered.map(item => `
            <tr>
                <td>${item.ì‹œë„ëª… || '-'}</td>
                <td>${item.í•™êµëª… || '-'}</td>
                <td>${item.í•™êµêµ¬ë¶„ëª… || '-'}</td>
                <td>${item.í•™ê³¼ëª… || '-'}</td>
                <td>${item.ì£¼ì•¼ê³¼ì •ëª… || '-'}</td>
            </tr>
        `).join('');

        if(filtered.length === 0) {
            tbody.innerHTML = '<tr><td colspan="5" class="no-result">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
        }
    }
</script>

</body>
</html>